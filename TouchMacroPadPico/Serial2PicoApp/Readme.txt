One or many files can be copied from the PC App to the Pico Macropad using the [Select and Send Files] button on the Comms tab. This button has a dual-function: After an intial selection of one or more files, the combobox next to the button is filled with the list of files sent. If one of these are selected, or a new file and its path typed into the combobox, the button when pressed will not first open a dialog box to select files but will send the single file selected immediately to the MacroPad.  The Pico macropad will name these files numerically as file1 to file 9999. A filename sync will be implemented later, for the time being use <*rn*file1=a01> for example, or use the [Ren] function in the Pico Editor itself to rename the new files. Note that the SDCard must be the destination i.e. A-D must be brown, these files should not be saved to Flash directly as they can be large. Use *sx* to reset the number count to 1. Use *sx*flename or *sx*/foldername/ to change the name used or path where files are saved -but these setting are not saved. The Pico is not a PC so when dragging more than ten or twenty files they should be small, or for larger files (maximum size is 6144 bytes), copy less than five at a time. This functionality is ideal for uploading a set of nKeys - for example first upload a set of 9 keys where you used <*sx*n0> to set the base filename, then upload the rest (up to about 980 more), with a base filename <*sx*n>. The filecount will not reset between uploads unless you use <*sx*>. To reset filename to null use *sx*** and use *sx*// to set foldername to null. In summary: *sx*name where name = filename or /foldername/ or // folder = "" or ** filename = "" or if no name reset filenumber to 1.

There is a screen video which illustrates this new function - SelectandSendFiles.gif.

Older versions without this functionality are Serial2Pico42.zip or earlier, which should be used with VolumeMacroPad-Pico2-35IPS-327.zip, or VolumeMacroPad-Pico1-35IPS-422.zip.

Arduino Label Tools converts label.json files to Pico macropad label1,2,3 type Arduino files. See the example label001.json for the JSON format. Drag and drop the json label file into the form, then rename to LabelM,S,T and copy to SDCard. Can send Label.json files to macropad via PC App. Use the checkbox in config tab if LabelM,S,T file must be automatically updated when new labelfiles are uploaded. labelfiles are saved as label1,2,3 depending if L1,l2,L3 upload used.

After generating a list files on the SDCard and Flash memory with the File List option from the Config Tab, a right-click on the selected filename gives the option to delete or view the file (in a readable format). If the file is in the SDCard list make sure the A-D indicator is brown, and similarly white A-D if in the Flash listing, before clicking on one of the two options. The other three options  (Clear, Copy, and  Select all), are text and not file operation options.

Instructions for Serial2Pico with json Symbols Bank loader:
1. Put your json math0.json to math9.json files in a folder such as C:\Temp, or any other folder.
2. Open Serial2Pico - you may get two messages that the math bank file cannot be found - click OK on each message.
3. Open the Config tab and press on the [...] button to select your default symbols bank file.
4. The location will be saved in C:\Users\User\AppData\Local\Serial2Pico\xyz\user.config

To send a symbols bank to the LCD touchpad select a file with the [...] button in the Symbols tab, enter a number 0 to 9 in the combo-box just below the box where the selected filename is, and the press [Send File]. The LCD should confirm it with the name of the symbols bank such as Math4. You then must load the bank in the LCD using the Load key. Note that if you had chosen a file named math3.json and entered 6 in the box below the filename the LCD will save the file as Math6.

The combo-box at the bottom loads symbol banks 0-9 from the default location into the PC App. After selecting a bank press Page1-4 once to see the new bank.

An example how to use the Send List in the Comms Tab to copy files: Copy file LabelT from SDCard to Flash - On the macropad press Pad [k] then press Pad [o] until the source on the left is brown and the destination on the right is white. On the PC App enter the string <*cf*LabelT=LabelT> in the textbox to the left of the button [Send List], and then press [Send List] to copy the file. As an alternative to using the macropad send <*ae*2> to change the Source=SDCard and Destination=Flash before sending the copy command. Note that <*ae*1> would copy from Flash to SDCard (because 1 = 01 and 2 = 10).

Refer to Win11-77.png for a layout of the Symbols tab.
----------------------------------------------------------------------------------------------------------------------------------------------------------
A PC Windows-based configuration tool for the Pico Touch LCD in its early development stages is included in the folder Serial2PicoApp - it will be developed over the next few months if not years. Additional tabs that must still be completed include configurations tabs for the Power and Macro Timer-Clocks, a tab for associating PC apps with macros, and a general configuration tab for various parameters such as LCD timeouts etc. Note that after unzipping the app, running the executable the first time will download and install .Net 8 run times. Pressing keys on the PC app can press the same key on the TouchLCD, which then through USB HID, send the keypress back to the PC. Start the app by selecting the Pico COM port, then press Open port, and then press Get Config to load the Pico's current configuration into the app. After the first start it should remember the COM port used and it will then automatically load the configuration after the Open port is pressed.

When the app is minimzed it will move to the system tray - click on the icon there to open it again. The app can be switched to three sizes (Tab row + Keypad + Config panel or by removing the Tab row and/or Config panel), using the green and blue up and down arrows in the lowest part of the keypad. The sizes can be changed by entering it in the Config tab - it will save the new sizes automatically. A useful direct key control has been added - switch the nKeys via the Config tab to Control - all 17 keys on any page of the LCD can then be pressed from the PC. To use the nKey or M,S,T bank of keys select from the 2 boxes "Press MST Keys with Delay" and/or "Send nKeys with Delay" (select a delay from the combobox next to Delay). To use the 8 other keys i.e. Cut, Copy, Paste, Delete, and Return (or the keys that replaced them), select the box "Press other Keys with Delay" (select a delay from the combobox close to the label). If the TouchlCD is in the dimmed state te first keypress will be ignored and is only used to wake the Macropad. When using the nKeys remember to switch the middle pad to E=Execute and not S=Show, and check that the SDCard or Flash selected is the medium that has the nKeys files. Note that there is also an automatic focus shift to the next opened app on the desktop: Use the delay=* or the Alt+Esc option instead of a manual focus change for PC App using "*" for delay value after key pressed on PC app. For example <k103*> is sent from the PC App (also possible to do by using the Comms tab and the Send list button), or when key [S1] is pressed with checkbox selected with Delay = *. This will then send (in my case) a textstring to the next visible app which is notepad using Alt+Esc to move the focus to notepad and then print the textstring.

The Glyph section is completed and can already send glyphs banks and symbols as json files either directly or via the LCD Send, or store them in the Windows clipboard, for use in MSWord or Libre Office. If * is chosen for the Delay (default), then the focus will automatically change to the next open program such as Word by using Alt+Esc before the Glyphs is sent. Other ways include changing focus from the PC app to Word manually, i.e. send the glyph with a selected delay of about 1/2 to 2 seconds, or choose the option to trigger it from the macropad send key. Instructions for selecting the default Symbol Bank folder are in the Serial2PicoApp folder. Test the Glyphs function directly by using the Comms tab and the Send list button, and then sending <g2211*1> with Word open - the Sum glyphs should be written in Word after the focus has changed automatically from the PC App to Word.

To use Timer 1 (Power and Restart) in synchronous mode with the MacroPad i.e. the Pad screen will mimic that of the PC App, select in L2 either of the two checkboxes to Press Keys, then click [Cfg], then [ROf], then click one of the Timers. Make sure the LCD screen shows the same as the PC App - note that when the LCD is dimmed the first keypress will be ignored and used to wake the LCD. When you are in the mode where the [Cfg] button is [Sav] and you do not want to save the current configuration click [L2]. All 12 keys in Layout 2 is now functional but in the next layer when [Cfg] is pressed [mCT], [Opt], and [Key] must still be configured. The three media keys [Med], [Vm], [Vol] in this section are working in configuration mode - i.e. after changes press the "Change key", and also in mimic mode if the "Press other keys" is on.

Note that the standard manner in which applications such as on-screen-keyboards work around the focus problem is to override two classes that ensures that the on-screen keyboard application doesn't gain the focus as a result of mouse clicks, and also prevents the form from coming to the foreground upon loading, are not suitable for this specific program, as it needs to be able to also function as a normal keep-focus form and form decorations, such as buttons.

Much of the C# code (but not the tab layout design), has been with the help of Google (Gemini), and various Copilot incantations such as the GitHub, Windows 11, and Visual Studio ones, whilst ChatGPT solved many of the trickier problems. A standalone PC clone of the TouchLCD is also planned for the far future.

Serial2Pico loads the current button definitions, labels, Layouts and Layers configuration from the TouchLCD as either raw data or text data, when the Get Config button on the Main tab of Serial2Pico is pressed. This needs a new version of the TouchLCD firmware, but can be used with the older firmware but then with less functions. The latest firmware is uploaded here as VolumeMacroPad-Pico2-35IPS-325.zip and VolumeMacroPad-Pico1-35IPS-410.zip in the Build folders of the Pico 1 and 2 versions.
