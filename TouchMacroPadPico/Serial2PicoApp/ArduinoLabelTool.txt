Code provided by ChatGPT

using System;
using System.IO;
using System.Text;
using System.Text.Json;
using System.Windows.Forms;

namespace ArduinoLabelTool
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            AllowDrop = true;
            Text = "Drop Label JSON Here";
            Width = 400;
            Height = 120;

            DragEnter += Form1_DragEnter;
            DragDrop += Form1_DragDrop;
        }

        private void Form1_DragEnter(object sender, DragEventArgs e)
        {
            if (e.Data.GetDataPresent(DataFormats.FileDrop))
                e.Effect = DragDropEffects.Copy;
        }

        private void Form1_DragDrop(object sender, DragEventArgs e)
        {
            var files = (string[])e.Data.GetData(DataFormats.FileDrop);

            foreach (var file in files)
            {
                if (Path.GetExtension(file).ToLower() == ".json")
                {
                    try
                    {
                        ConvertJsonToArduinoFile(file);
                        MessageBox.Show($"Created: {Path.ChangeExtension(file, ".bin")}");
                    }
                    catch (Exception ex)
                    {
                        MessageBox.Show(ex.Message);
                    }
                }
            }
        }

        private void ConvertJsonToArduinoFile(string jsonPath)
        {
            string json = File.ReadAllText(jsonPath);
            var labelFile = JsonSerializer.Deserialize<LabelFile>(json);

            if (labelFile.Labels.Length != 24)
                throw new Exception("JSON must contain exactly 24 labels.");

            string outputPath = Path.ChangeExtension(jsonPath, ".bin");

            using var fs = new FileStream(outputPath, FileMode.Create);
            using var bw = new BinaryWriter(fs);

            foreach (var label in labelFile.Labels)
            {
                if (label.Length > 5)
                    throw new Exception($"Label '{label}' is longer than 5 characters.");

                byte[] buffer = new byte[5]; // auto 0x00 padded
                var ascii = Encoding.ASCII.GetBytes(label);
                Array.Copy(ascii, buffer, ascii.Length);

                bw.Write(buffer);      // 5 bytes
                bw.Write((byte)0x00); // terminator
            }
        }
    }

    public class LabelFile
    {
        public string[] Labels { get; set; }
    }
}

====================================================================

using System;
using System.IO;
using System.Text;
using System.Text.Json;

public class LabelFile
{
    public string[] Labels { get; set; }
}

class Program
{
    static void Main()
    {
        ConvertJsonToArduinoFile("LabelM.json", "LabelM.bin");
    }

    static void ConvertJsonToArduinoFile(string jsonPath, string outputPath)
    {
        var json = File.ReadAllText(jsonPath);
        var labelFile = JsonSerializer.Deserialize<LabelFile>(json);

        if (labelFile.Labels.Length != 24)
            throw new Exception("JSON must contain exactly 24 labels.");

        using var fs = new FileStream(outputPath, FileMode.Create);
        using var bw = new BinaryWriter(fs);

        foreach (var label in labelFile.Labels)
        {
            if (label.Length > 5)
                throw new Exception($"Label '{label}' is longer than 5 characters.");

            byte[] buffer = new byte[5]; // pre-filled with 0x00

            var ascii = Encoding.ASCII.GetBytes(label);
            Array.Copy(ascii, buffer, ascii.Length);

            // Write 5 bytes (chars + 0 padding)
            bw.Write(buffer);

            // Write terminator
            bw.Write((byte)0x00);
        }
    }
}


static void ConvertArduinoFileToJson(string binPath, string jsonPath)
{
    byte[] data = File.ReadAllBytes(binPath);

    if (data.Length != 144)
        throw new Exception("Invalid file size. Must be 144 bytes.");

    string[] labels = new string[24];

    for (int i = 0; i < 24; i++)
    {
        int offset = i * 6;

        int len = 0;
        while (len < 5 && data[offset + len] != 0x00)
            len++;

        labels[i] = Encoding.ASCII.GetString(data, offset, len);
    }

    var obj = new LabelFile { Labels = labels };
    var json = JsonSerializer.Serialize(obj, new JsonSerializerOptions { WriteIndented = true });

    File.WriteAllText(jsonPath, json);
}

